---
title: "draft puntos"
author: "Sergio Andrés Niño Marín"
date: "17/9/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## 4



```{r gamma inversa previa posterior, echo=FALSE}
#ikipdia dice que beta con esa pdf es escala, pero es fake(o r considera escala lo inverso)
 library(invgamma)
 set.seed(1234)

lambda <- seq(0.005, 10000, length = 10000)
plot(NA, NA, xlim = c(1000,10000),ylim = c(0,0.0004091411),  xlab = expression(lambda), ylab = "densidad", main = "Posterior")
lines(lambda, dinvgamma(lambda,33/4 , 33625), col = 2, lwd = 2)
lines(lambda, dinvgamma(lambda,33/4 + 14,  33625 +70612 ), col = 4, lwd = 2)
abline(h = 0, col = 1)
legend("topright", legend = c( "Previa" , "posterior"), bty = "n", lwd = 2, col = c(2, 4))
```

##6

```{r muestra inicial y estimaciones bayes}

library(invgamma)
datos1 <- c(495, 541, 1461, 1555, 1603, 2201, 2750, 3468, 3516, 4319, 6622, 7728, 13159, 21194)
suma1 <- sum(datos1)
n1 <- length(datos1)
beta_post1 <-32625 + suma1 
alpha_post1 <- ((33/4)+n1)
media_posterior1 <-((32625 + suma1)/((33/4)+n1)-1)
IC_bayes1 <-qinvgamma(p = c(.025,.975),shape = alpha_post1,rate = beta_post1)
var_post1 <- (beta_post1^2)/(((alpha_post1 -1)^2)*(alpha_post1 - 2))
CV_bayes1 <-  sqrt(var_post1)/media_posterior1



```

```{r  estimaciones bootstrap}
library(stats)

set.seed(1234)

 muestras_boot<- replicate(10000,sample(datos1, replace = T))
medias_boot <- apply(muestras_boot,MARGIN = 2, FUN = mean)
media_pred_boot <- mean(medias_boot)
var_boot <- var(medias_boot) 
CV_boot <-  sqrt(var_boot)/media_pred_boot
IC_boot <- quantile(medias_boot, probs = c(.025,.975))

```

```{r  estimaciones MLE}
library(mle.tools)

media_MLE <- mean(datos1)

pdf_yprevia <- quote(rate * exp(-rate * x))
logpdf_yprevia <- quote(log(rate) - rate * x)

info_fisher <- expected.varcov(density = pdf_yprevia, logdensity = logpdf_yprevia, n = n1, parms = c("rate"),
 mle = media_MLE, lower = 0)  #tomado del help del paquete

CV_MLE <-  sqrt(as.numeric(info_fisher$varcov))/info_fisher$mle # no sé si está bien xd


```

```{r probabilidades 4000 }
library(invgamma)

prob_lambda4000 <- pinvgamma(4000,alpha_post1,beta_post1)

prob_ypred <- (beta_post1^(-alpha_post1)) - ((beta_post1 + 4000)^(-alpha_post1))

```

